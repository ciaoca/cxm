<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>AJAX 加载样式 - cxStyle</title>
<meta name="keywords" content="">
<meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
<meta name="viewport" content="initial-scale=1.0, maximum-scale=1, user-scalable=no" media="(device-height:568px)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="apple-touch-fullscreen" content="yes">
<meta name="format-detection" content="telephone=no">
<link rel="stylesheet" href="../../static/css/cxm.css">
<link rel="stylesheet" href="../../static/demo/css/layout.css">
<script src="../../static/js/zepto.min.js"></script>
<script src="../../static/default/js/plugins.js"></script>
<script src="../../static/default/js/init.js"></script>
</head>
<body>
<div class="wrap">
  <div id="header" class="header">
    <header>
      <h1>列表加载</h1>
      <a class="icon back" href="index.html"></a>
    </header>
  </div>

  <div class="form">
    <input type="radio" name="_state" id="state_load" class="radio" value="load" checked><label for="state_load">加载中</label>
    <input type="radio" name="_state" id="state_empty" class="radio" value="empty"><label for="state_empty">无数据</label>
    <input type="radio" name="_state" id="state_ready" class="radio" value="ready"><label for="state_ready">上拉加载</label>
    <input type="radio" name="_state" id="state_end" class="radio" value="end"><label for="state_end">已到尾页</label>
  </div>

  <ul id="ajax_list" class="ajax_list load" data-empty-tip="暂无数据" data-end-tip="已显示全部"></ul>

  <footer class="footer"></footer>
</div>

<script src="../../static/default/js/ready.js"></script>
<script>
(function() {
  var thePage = {
    dom: {}
  };

  thePage.init = function() {
    var self = this;

    self.dom.list = $('#ajax_list');
    self.dom.pull = $('<div></div>');

    self.dom.pull.attr('class', 'loading').insertAfter(self.dom.list);

    $('body').on('change', 'input', function(event) {
      var _this = this;
      var _type = _this.type;
      var _name = _this.name;
      var _value = _this.value;

      if (_type && _this.checked && _name === '_state') {
        self.changeStaty(_value);
      };
    });
  };

  thePage.changeStaty = function(name) {
    var self = this;
    var _class = ['empty', 'load', 'ready', 'end'];

    switch (name) {
      case 'empty':
        self.dom.list.empty();
        break;

      case 'load':
        self.dom.pull.attr('class', 'loading');
        break;

      case 'ready':
        self.dom.list.html('<li>1</li><li>2</li><li>3</li>');
        self.dom.pull.attr('class', 'pull');
        break;

      // not default
    };

    if (_class.indexOf(name)) {
      _class.splice(_class.indexOf(name), 1);
    };

    self.dom.list.removeClass(_class.join(' ')).addClass(name);
  };

  thePage.init();
})();
</script>
</body>
</html>
