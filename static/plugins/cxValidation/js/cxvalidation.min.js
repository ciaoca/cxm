/*!
 * cxValidation
 * 
 * @version 1.0.0
 * @author ciaoca
 * @email ciaoca@gmail.com
 * @site https://github.com/ciaoca/cxValidation
 * @license Released under the MIT license
 */
!function(a){"use strict";var d,c={validMessage:{titleSymbol:{before:"【",after:"】"},required:{input:"未填写",radio:"未选择",checkbox:"未勾选",select:"未选择"},groupRequired:{input:"至少填写 {{1}} 项",radio:"未选择",checkbox:"至少选择 {{1}} 项"},condRequired:{input:"未填写",radio:"未选择",checkbox:"未勾选",select:"未选择"},equals:"两次输入内容不一致",minSize:"最少 {{0}} 个字符",maxSize:"最多 {{0}} 个字符",min:"最小值为 {{0}}",max:"最大值为 {{0}}",integer:"无效的整数",number:"无效的数值",onlyNumber:"只能填写数字",onlyNumberSp:"只能填写数字和空格",onlyLetter:"只能填写英文字母",onlyLetterSp:"只能填写英文字母和空格",onlyLetterNumber:"只能填写英文字母与数字",onlyLetterNumberSp:"只能填写英文字母、数字、空格",email:"无效的邮件地址",phone:"无效的电话号码",url:"无效的网址",chinese:"只能填写中文汉字",chinaId:"无效的身份证号码",chinaIdLoose:"无效的身份证号码",chinaZip:"无效的邮政编码",qq:"无效的 QQ 号码"},result:{status:!0},vid:1,formFuns:{},groupCache:{},isElement:function(a){return a&&("function"==typeof HTMLElement||"object"==typeof HTMLElement)&&a instanceof HTMLElement?!0:a&&a.nodeType&&1===a.nodeType?!0:!1},isJquery:function(a){return a&&a.length&&("function"==typeof jQuery||"object"==typeof jQuery)&&a instanceof jQuery?!0:!1},isZepto:function(a){return a&&a.length&&("function"==typeof Zepto||"object"==typeof Zepto)&&Zepto.zepto.isZ(a)?!0:!1},isHidden:function(b){if(this.isElement(b)){var c=a.getComputedStyle(b);return"none"===c.getPropertyValue("display")||"hidden"===c.getPropertyValue("visibility")||0==c.getPropertyValue("opacity")||0==c.getPropertyValue("width")&&0==c.getPropertyValue("height")?!0:!1}return!0},isVisible:function(a){return!this.isHidden(a)}};c.init=function(){var a=this;a.defaults={success:function(a){a.form.submit()},error:function(b){var c=b.element.nodeName.toLowerCase();"required"===b.rule||"condRequired"===b.rule?"input"===c&&["radio","checkbox","color","range","file"].indexOf(b.element.type)>=0?a.toMessage(b.message):a.toFocus(b.element):a.toMessage(b.message)}}},c.validFun={required:function(a){return"checkbox"===a.type||"radio"===a.type?a.checked?!0:!1:a.value.trim().length?!0:!1},groupRequired:function(a,b,c){var d=this;return b=String(b),c=parseInt(c,10),isNaN(c)&&(c=1),("undefined"==typeof d.groupCache[b]||"undefined"==typeof d.groupCache[b].count)&&(d.groupCache[b]={count:c}),d.groupCache[b].count>0&&(d.validFun.required(a)?d.groupCache[b].count-=1:"undefined"==typeof d.groupCache[b].element&&(d.groupCache[b].element=a)),!0},condRequired:function(a,b,c){var g,h,d=this,e=!1,f=!0;if("string"==typeof b&&b.length){if(b.indexOf(",")>0){if(b=b.split(","),Array.isArray(b)&&b.length)for(e=!0,g=0,h=b.length;h>g;g++)if(!d.validFun.required(document.getElementById(b[g]))){e=!1;break}}else"string"==typeof c?document.getElementById(b).value===c&&(e=!0):d.validFun.required(document.getElementById(b))&&(e=!0);e&&(f=d.validFun.required(a))}return f},equals:function(a,b){return a.value==document.getElementById(b).value},minSize:function(a,b){return a.value.length?a.value.length>=b:!0},maxSize:function(a,b){return a.value.length?a.value.length<=b:!0},min:function(a,b){return a.value.length?parseFloat(a.value)>=b:!0},max:function(a,b){return a.value.length?parseFloat(a.value)<=b:!0},integer:function(a){return a.value.length?/^[\-\+]?\d+$/.test(a.value):!0},number:function(a){return a.value.length?/^[\-\+]?((([0-9]{1,3})([,][0-9]{3})*)|([0-9]+))?([\.]([0-9]+))?$/.test(a.value):!0},onlyNumber:function(a){return a.value.length?/^[0-9]+$/.test(a.value):!0},onlyNumberSp:function(a){return a.value.length?/^[0-9\ ]+$/.test(a.value):!0},onlyLetter:function(a){return a.value.length?/^[a-zA-Z]+$/.test(a.value):!0},onlyLetterSp:function(a){return a.value.length?/^[a-zA-Z\ ]+$/.test(a.value):!0},onlyLetterNumber:function(a){return a.value.length?/^[0-9a-zA-Z]+$/.test(a.value):!0},onlyLetterNumberSp:function(a){return a.value.length?/^[0-9a-zA-Z\ ]+$/.test(a.value):!0},email:function(a){return a.value.length?/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(a.value):!0},phone:function(a){return a.value.length?/^([\+][0-9]{1,3}[ \.\-])?([\(]{1}[0-9]{2,6}[\)])?([0-9 \.\-\/]{3,20})((x|ext|extension)[ ]?[0-9]{1,4})?$/.test(a.value):!0},url:function(a){return a.value.length?/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a.value):!0},chinese:function(a){return a.value.length?/^[\u4E00-\u9FA5]+$/.test(a.value):!0},chinaId:function(a){return a.value.length?/^[1-9]\d{5}[1-9]\d{3}(((0[13578]|1[02])(0[1-9]|[12]\d|3[0-1]))|((0[469]|11)(0[1-9]|[12]\d|30))|(02(0[1-9]|[12]\d)))(\d{4}|\d{3}[xX])$/.test(a.value):!0},chinaIdLoose:function(a){return a.value.length?/^(\d{18}|\d{15}|\d{17}[xX])$/.test(a.value):!0},chinaZip:function(a){return a.value.length?/^\d{6}$/.test(a.value):!0},qq:function(a){return a.value.length?/^[1-9]\d{4,10}$/.test(a.value):!0},call:function(){var b=Array.prototype.slice.call(arguments),c=b.splice(1,1),d=a;if(c.indexOf(".")>=0)for(c=c.split(".");c.length;)d=d[c.shift()];else d=d[c];return"function"==typeof d?d.apply(d,b):!0}},c.getRuleArguments=function(a,b){var e,c=a.dataset.validation,d=[],f=[];return"string"==typeof c&&c.length&&(d=c.replace(/\s|\[[^\]]*\]/g,"").split(",")),"string"==typeof b&&b.length&&d.indexOf(b)>=0&&(e=c.match(new RegExp(b+"((\\[[^\\]]+\\])+)")),Array.isArray(e)&&e.length>1&&(f=e[1].match(/([^\[\]]+)/g),Array.isArray(f)&&1===f.length&&"groupRequired"===b&&(f[1]=1))),f},c.getMessage=function(a,b){var e,h,i,c=this,d="",f=a.nodeName.toLowerCase();if("string"==typeof a.dataset.validationMessage&&a.dataset.validationMessage.length)try{d=JSON.parse(a.dataset.validationMessage),"string"==typeof d[b]&&d[b].length&&(d=d[b])}catch(g){d=a.dataset.validationMessage}else("string"==typeof c.validMessage[b]||"object"==typeof c.validMessage[b])&&("string"==typeof c.validMessage[b]?d=c.validMessage[b]:"input"===f?"radio"===a.type&&"string"==typeof c.validMessage[b].radio?d=c.validMessage[b].radio:"checkbox"===a.type&&"string"==typeof c.validMessage[b].checkbox?d=c.validMessage[b].checkbox:"string"==typeof c.validMessage[b].input&&(d=c.validMessage[b].input):"select"===f&&"string"==typeof c.validMessage[b].select?d=c.validMessage[b].select:"string"==typeof c.validMessage[b].input&&(d=c.validMessage[b].input),d.length&&"string"==typeof a.dataset.validationTitle&&a.dataset.validationTitle.length&&(d=c.validMessage.titleSymbol.before+a.dataset.validationTitle+c.validMessage.titleSymbol.after+d));if(d.length)for(e=c.getRuleArguments(a,b),h=0,i=e.length;i>h;h++)d=d.replace(new RegExp("\\{\\{"+h+"\\}\\}"),e[h]);return d},c.validItem=function(a,b){var g,h,i,j,k,c=this,d=$.extend({},c.result),e=a.dataset.validation,f=[];if("string"==typeof e&&e.length)for(f=e.replace(/\s|\[[^\]]*\]/g,"").split(","),j=0,k=f.length;k>j;j++)if(i=f[j],"function"==typeof c.validFun[i]&&(g=e.match(new RegExp(i+"((\\[[^\\]]+\\])+)")),h=[a],Array.isArray(g)&&g.length>1&&(h=h.concat(g[1].match(/([^\[\]]+)/g))),d=c.validFun[i].apply(c,h),"boolean"==typeof d&&(d={status:d}),$.isPlainObject(d)&&"boolean"==typeof d.status&&d.status===!1)){d.rule=i,"string"==typeof d.message&&d.message.length||(d.message=c.getMessage(a,i));break}return d.element=a,b===!0?d:d.status},c.validForm=function(a,b,c){var g,h,d=this,e=$.extend({},d.result),f="boolean";if(b===!0?f="object":"function"==typeof b&&(b={success:b}),b=$.extend({},b),"function"==typeof c&&(b.error=c),g=a.querySelectorAll("input,textarea,select"),d.groupCache={},$.each(g,function(a,b){var c=d.validItem(b,!0);return c&&c.status===!1?(e.status=!1,e.element=b,"string"==typeof c.rule&&c.rule.length&&(e.rule=c.rule),"string"==typeof c.message&&c.message.length&&(e.message=c.message),!1):void 0}),e&&e.status===!0)for(h in d.groupCache)if(d.groupCache[h].count>0){e.status=!1,e.rule="groupRequired",e.element=d.groupCache[h].element,e.message=d.getMessage(e.element,e.rule);break}return d.groupCache={},e.form=a,"function"==typeof b.complete&&b.complete(e),e.status===!0&&"function"==typeof b.success?b.success(e):e.status===!1&&"function"==typeof b.error&&b.error(e),"object"===f?e:e.status},c.formSubmitFn=function(a,b){event.preventDefault();var c=this;b=$.extend({},c.defaults,b),c.validForm(a,b)},c.toMessage=function(a){alert(a)},c.toFocus=function(a){var b=this;b.isVisible(a)&&a.focus()},c.init(),d=function(){return d.valid.apply(d,arguments)},d.setOptions=function(a){$.extend(c.defaults,a)},d.setLanguage=function(a){$.extend(!0,c.validMessage,a)},d.valid=function(a,b){return(c.isJquery(a)||c.isZepto(a))&&(a=a[0]),c.isElement(a)?"form"===a.nodeName.toLowerCase()?c.validForm(a,b):c.validItem(a,b):!1},d.attach=function(){var b,e,f,g,d={};for(e=0,f=arguments.length;f>e;e++)c.isElement(arguments[e])?b=arguments[e]:c.isJquery(arguments[e])||c.isZepto(arguments[e])?b=arguments[e][0]:"function"==typeof arguments[e]?"function"==typeof d.success?d.error=arguments[e]:d.success=arguments[e]:"object"==typeof arguments[e]&&(d=$.extend(d,arguments[e]));return c.isElement(b)&&b.nodeName&&"form"===b.nodeName.toLowerCase()?(g=b.dataset.cxVid,"function"!=typeof c.formFuns[g]?(g="cxValid_"+c.vid,b.dataset.cxVid=g,c.vid++):b.removeEventListener("submit",c.formFuns[g]),c.formFuns[g]=c.formSubmitFn.bind(c,b,d),b.addEventListener("submit",c.formFuns[g]),void 0):(console.warn("[cxValidation] Not form element."),!1)},d.detach=function(a){if((c.isJquery(a)||c.isZepto(a))&&(a=a[0]),!c.isElement(a)||!a.nodeName||"form"!==a.nodeName.toLowerCase())return!1;var d=a.dataset.cxVid;return delete a.dataset.cxVid,d&&"function"==typeof c.formFuns[d]?(a.removeEventListener("submit",c.formFuns[d]),delete c.formFuns[d],void 0):!1},$.cxValidation=a.cxValidation=d}(window);